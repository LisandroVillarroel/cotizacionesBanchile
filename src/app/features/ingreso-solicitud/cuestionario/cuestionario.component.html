<form [formGroup]="documentForm()" novalidate style="margin-top: 32px">
  <mat-card class="form-card card-borde card-con-titulo-principal mat-elevation-z6" data-titulo="Documentos Asociados">
    <div class="modifica-container-cuestionario" style="display: flex; flex-direction: row; gap: 2%; align-items: stretch">

      <!-- Sección izquierda: documento obligatorio -->
      <div style="width: 32%; display: flex; align-items: flex-start">
        <mat-card class="form-card-cuestionario card-borde-cuestionario card-con-titulo contenido-card-cuestionario mat-elevation-z6" data-titulo="Cuestionario Obligatorio (*)" style="width: 100%">
          <div>
            @for (doc of documentos(); track doc.p_id_documento_adjunto) {
              @if (doc.p_documento_principal === 'Requerido') {
                <div style="width: 100%" [attr.data-titulo]="doc.p_id_documento_adjunto + ' (* Obligatorio)'">
                  <div class="document-section" style="display: flex; align-items: center">
                    <mat-form-field appearance="outline" class="inputInput-cuestionario" style="flex-grow: 1; min-width: 0">
                      <mat-label class="labelI-cuestionario">{{ doc.p_id_documento_adjunto }}</mat-label>
                      <input matInput aria-label="labelI-cuestionario" disabled [value]="doc.p_ruta_documento_origen || ''" />
                    </mat-form-field>

                    <button type="button" mat-icon-button color="primary" class="boton-cargar-cuestionario"
                      (click)="abrirInputArchivo(doc.p_id_documento_adjunto)" matTooltip="Cargar documento">
                      <mat-icon>upload</mat-icon>
                    </button>

                    <input type="file" hidden [id]="sanitizarNombre(doc.p_id_documento_adjunto)" #fileInputs
                      (change)="onFileSelected($event, doc)" />

                    @if (doc.p_ruta_documento_origen) {
                      <button type="button" mat-icon-button color="warn" class="boton-eliminar-cuestionario"
                        (click)="eliminarDocumento(doc)" matTooltip="Eliminar documento">
                        <mat-icon>delete</mat-icon>
                      </button>
                    }
                  </div>
                </div>
              }
            }
          </div>
        </mat-card>
      </div>

      <!-- Divider -->
      <mat-divider [vertical]="true" style="height: auto; margin: 0"></mat-divider>

      <!-- Sección derecha: documentos opcionales -->
      <div style="width: 66%">
        <mat-card class="form-card-cuestionario card-borde-cuestionario card-con-titulo contenido-card-cuestionario mat-elevation-z6"
          [ngClass]="{ 'card-disabled': bloquearSeccion2() }" data-titulo="Documentos Opcionales" style="width: 100%">
          <div style="display: flex; flex-direction: row; justify-content: space-between">

            <!-- Columna izquierda -->
            <div style="width: 48%">
              @for (doc of documentos(); track doc.p_id_documento_adjunto) {
                @if (doc.p_documento_principal === 'Opcional' && ['Carta Gantt', 'Descripción de la obra', 'Medidas de seguridad'].includes(doc.p_id_documento_adjunto)) {
                  <div style="width: 100%" [attr.data-titulo]="doc.p_id_documento_adjunto">
                    <div class="document-section" style="display: flex; align-items: center">
                      <mat-form-field appearance="outline" class="inputInput-cuestionario" style="flex-grow: 1; min-width: 0">
                        <mat-label class="labelI-cuestionario">{{ doc.p_id_documento_adjunto }}</mat-label>
                        <input matInput aria-label="labelI-cuestionario" disabled [value]="doc.p_ruta_documento_origen || ''" />
                      </mat-form-field>

                      <button type="button" mat-icon-button color="primary" class="boton-cargar-cuestionario"
                        (click)="abrirInputArchivo(doc.p_id_documento_adjunto)" matTooltip="Cargar documento"
                        [disabled]="bloquearSeccion2()">
                        <mat-icon>upload</mat-icon>
                      </button>

                      <input type="file" hidden [id]="sanitizarNombre(doc.p_id_documento_adjunto)" #fileInputs
                        (change)="onFileSelected($event, doc)" />

                      @if (doc.p_ruta_documento_origen) {
                        <button type="button" mat-icon-button color="warn" class="boton-eliminar-cuestionario"
                          (click)="eliminarDocumento(doc)" matTooltip="Eliminar documento"
                          [disabled]="bloquearSeccion2()">
                          <mat-icon>delete</mat-icon>
                        </button>
                      }
                    </div>
                  </div>
                }
              }
            </div>

            <!-- Columna derecha -->
            <div style="width: 48%">
              @for (doc of documentos(); track doc.p_id_documento_adjunto) {
                @if (doc.p_documento_principal === 'Opcional' && ['Plano/Layout de la obra', 'Presupuesto', 'Documentos adicionales'].includes(doc.p_id_documento_adjunto)) {
                  <div style="width: 100%" [attr.data-titulo]="doc.p_id_documento_adjunto">
                    <div class="document-section" style="display: flex; align-items: center">
                      <mat-form-field appearance="outline" class="inputInput-cuestionario" style="flex-grow: 1; min-width: 0">
                        <mat-label class="labelI-cuestionario">{{ doc.p_id_documento_adjunto }}</mat-label>
                        <input matInput aria-label="labelI-cuestionario" disabled [value]="doc.p_ruta_documento_origen || ''" />
                      </mat-form-field>

                      <button type="button" mat-icon-button color="primary" class="boton-cargar-cuestionario"
                        (click)="abrirInputArchivo(doc.p_id_documento_adjunto)" matTooltip="Cargar documento"
                        [disabled]="bloquearSeccion2()">
                        <mat-icon>upload</mat-icon>
                      </button>

                      <input type="file" hidden [id]="sanitizarNombre(doc.p_id_documento_adjunto)" #fileInputs
                        (change)="onFileSelected($event, doc)" />

                      @if (doc.p_ruta_documento_origen) {
                        <button type="button" mat-icon-button color="warn" class="boton-eliminar-cuestionario"
                          (click)="eliminarDocumento(doc)" matTooltip="Eliminar documento"
                          [disabled]="bloquearSeccion2()">
                          <mat-icon>delete</mat-icon>
                        </button>
                      }
                    </div>
                  </div>
                }
              }
            </div>

          </div>
        </mat-card>
      </div>

    </div>
  </mat-card>

</form>
