<mat-card class="fondoGris alinea-card-gestion" >
  <mat-card-title>
    <h3 mat-dialog-title class="mt-2 titulo">Solicitudes gestionadas el último mes en curso</h3>
  </mat-card-title>

  <mat-card-content class="d-flex p-0 justify-around" style="width: 100%;">
    <div class="container-fluid p-0">
      <div class="box-form-fields p-2 gap-2" style="align-items: center;">

        <div class="gap-1" style="width: 10%;">
           <span class="gris"> Filtrar por: </span>
        </div>

        <div style="width: 20%;">
          <mat-form-field class="inputBuscar">
            <mat-label class="labelI">Contratante</mat-label>
            <mat-icon matSuffix class="gris">search</mat-icon>
            <input matInput #coordinadorInput id="contratanteInput"
            (keyup)="applyFilterSolicitud('Contratante',coordinadorInput.value)" />
          </mat-form-field>
        </div>

        <div style="width: 20%;">
          <mat-form-field class="inputSelect">
            <mat-label class="labelI">Rubro</mat-label>
            <mat-select [formControl]="rubro" (selectionChange)="seleccionaRubro($event.value)">
              @for(_seguros of datoRubros(); track _seguros){
                <mat-option [value]="_seguros.codigoRubro">
                  {{ _seguros.descripcionRubro }}
                </mat-option>
              }
            </mat-select>
          </mat-form-field>
        </div>

        <div style="width: 20%;">
          <mat-form-field class="inputSelect">
            <mat-label class="labelI">Tipo de seguro</mat-label>
            <mat-select [formControl]="seguro" (selectionChange)="applyFilterSolicitud('TipoSeguro',$event.value)">
              @for(_seguros of rescatadoSeguro(); track _seguros){
                <mat-option [value]="_seguros.descripcionSeguro">
                  {{ _seguros.descripcionSeguro }}
                </mat-option>
              }
              <input matInput  />
            </mat-select>
          </mat-form-field>
        </div>

        <div style="width: 20%;">
          <mat-form-field class="inputSelect">
            <mat-label class="labelI">Estado</mat-label>
            <mat-select [formControl]="estado" (selectionChange)="applyFilterSolicitud('Estado',$event.value)">
              @for(_seguros of rescatadoSeguro(); track _seguros){
                <mat-option [value]="_seguros.descripcionSeguro">
                  {{ _seguros.descripcionSeguro }}
                </mat-option>
              }
              <input matInput  />
            </mat-select>
          </mat-form-field>
        </div>

        <div>
          <mat-form-field class="inputFechaForm">
            <mat-label class="fontSmall gris">Fecha</mat-label>
            <input matInput [matDatepicker]="picker">
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>

        <div class="gap-1" style="width: 10%;">
          <button mat-raised-button (click)="limpiaFiltros()" class="button-link"> Limpiar filtros
          </button>
        </div>
      </div>


      <div class="mat-elevation-z8">
        <table mat-table
              [dataSource]="dataSourceSolicitud"
              multiTemplateDataRows
              matSort>

          <ng-container matColumnDef="index">
            <th
              id="indexI"
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              style="width: 4%"
            >
              N°
            </th>
            <td
              mat-cell
              *matCellDef="let element; let i = dataIndex"
              class="gris"
              style="width: 4%"
            >
              {{ i + 1 + myPaginator.pageIndex * myPaginator.pageSize }}
            </td>
          </ng-container>

          <ng-container matColumnDef="ID">
            <th id="_id"
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                style="width: 8%"
              > ID </th>
            <td mat-cell *matCellDef="let element"> {{element.ID}} </td>
          </ng-container>

          <ng-container matColumnDef="Fecha">
            <th id="_fecha"
                mat-header-cell
                *matHeaderCellDef
                mat-sort-header
                style="width: 8%"
              > Fecha </th>
            <td mat-cell *matCellDef="let element"> {{element.Fecha}} </td>
          </ng-container>

          <ng-container matColumnDef="Contratante">
            <th
              id="_contratante"
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              style="width: 8%"
            >
              Contratante
            </th>
            <td mat-cell *matCellDef="let element">{{ element.Contratante }}</td>
          </ng-container>

          <ng-container matColumnDef="Rubro">
            <th
              id="_rubro"
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              style="width: 8%"
            >
              Rubro
            </th>
            <td mat-cell *matCellDef="let element">{{ element.Rubro }}</td>
          </ng-container>

          <ng-container matColumnDef="TipoSeguro">
            <th
              id="_tipoSeguro"
              mat-header-cell
              *matHeaderCellDef
              mat-sort-header
              style="width: 8%"
            >
              Tipo Seguro
            </th>
            <td mat-cell *matCellDef="let element">{{ element.TipoSeguro }}</td>
          </ng-container>

          <ng-container matColumnDef="Estado">
            <th
                  id="_estado"
                  mat-header-cell
                  *matHeaderCellDef
                  mat-sort-header
                  style="width: 8%"
                > Estado </th>
            <td mat-cell *matCellDef="let element">
              <div [ngClass]="getCellClass(element.Estado)">{{element.Estado}}</div>
            </td>
          </ng-container>

          <ng-container matColumnDef="accion">
            <th
              id="accionI"
              mat-header-cell
              *matHeaderCellDef
              style="width: 8%; text-align: center"
            >
              Acción
            </th>
            <td
              mat-cell
              *matCellDef="let row; let i = index"
              style="width: 8%; text-align: center"
            >
              <!-- <mat-icon class="destacado">visibility</mat-icon> -->
              <button
                matTooltip="Ver detalles"
                mat-icon-button
                class="tabla"
                (click)="verDetalle(row.ID)"
              >
                <mat-icon class="destacado">visibility</mat-icon>
              </button>
            </td></ng-container
          >

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>

        <mat-paginator
          #myPaginator
          [pageSizeOptions]="[10, 20, 30, 100]"
        ></mat-paginator>
      </div>
    </div>
  </mat-card-content>
</mat-card>
